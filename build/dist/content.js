(()=>{"use strict";var t={729:t=>{var e=Object.prototype.hasOwnProperty,s="~";function n(){}function o(t,e,s){this.fn=t,this.context=e,this.once=s||!1}function i(t,e,n,i,r){if("function"!=typeof n)throw new TypeError("The listener must be a function");var _=new o(n,i||t,r),l=s?s+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],_]:t._events[l].push(_):(t._events[l]=_,t._eventsCount++),t}function r(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function _(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(s=!1)),_.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(s?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},_.prototype.listeners=function(t){var e=s?s+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,r=new Array(i);o<i;o++)r[o]=n[o].fn;return r},_.prototype.listenerCount=function(t){var e=s?s+t:t,n=this._events[e];return n?n.fn?1:n.length:0},_.prototype.emit=function(t,e,n,o,i,r){var _=s?s+t:t;if(!this._events[_])return!1;var l,a,u=this._events[_],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,o),!0;case 5:return u.fn.call(u.context,e,n,o,i),!0;case 6:return u.fn.call(u.context,e,n,o,i,r),!0}for(a=1,l=new Array(c-1);a<c;a++)l[a-1]=arguments[a];u.fn.apply(u.context,l)}else{var h,g=u.length;for(a=0;a<g;a++)switch(u[a].once&&this.removeListener(t,u[a].fn,void 0,!0),c){case 1:u[a].fn.call(u[a].context);break;case 2:u[a].fn.call(u[a].context,e);break;case 3:u[a].fn.call(u[a].context,e,n);break;case 4:u[a].fn.call(u[a].context,e,n,o);break;default:if(!l)for(h=1,l=new Array(c-1);h<c;h++)l[h-1]=arguments[h];u[a].fn.apply(u[a].context,l)}}return!0},_.prototype.on=function(t,e,s){return i(this,t,e,s,!1)},_.prototype.once=function(t,e,s){return i(this,t,e,s,!0)},_.prototype.removeListener=function(t,e,n,o){var i=s?s+t:t;if(!this._events[i])return this;if(!e)return r(this,i),this;var _=this._events[i];if(_.fn)_.fn!==e||o&&!_.once||n&&_.context!==n||r(this,i);else{for(var l=0,a=[],u=_.length;l<u;l++)(_[l].fn!==e||o&&!_[l].once||n&&_[l].context!==n)&&a.push(_[l]);a.length?this._events[i]=1===a.length?a[0]:a:r(this,i)}return this},_.prototype.removeAllListeners=function(t){var e;return t?(e=s?s+t:t,this._events[e]&&r(this,e)):(this._events=new n,this._eventsCount=0),this},_.prototype.off=_.prototype.removeListener,_.prototype.addListener=_.prototype.on,_.prefixed=s,_.EventEmitter=_,t.exports=_}},e={};function s(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,s),i.exports}(()=>{const t=s(729);class e{constructor(e){this.extension=e,this.EVENT_NAMES={data:"onData",newURL:"onNewURL",start:"onStart"},this.eventEmitter=new t,this.debug=!1,this.navigate_delay=1500,this.debug?(this.result_text_pages=2,this.result_news_pages=2,this.result_images_pages=2,this.result_videos_pages=2,this.scroll_text_reloads=2,this.scroll_news_reloads=2,this.scroll_videos_reloads=2,this.scroll_images_reloads=2):(this.result_text_pages=5,this.result_news_pages=5,this.result_images_pages=5,this.result_videos_pages=5,this.scroll_text_reloads=3,this.scroll_news_reloads=3,this.scroll_videos_reloads=3,this.scroll_images_reloads=3),this.next_delay=2e3,this.initial_scroll_delay=1e3,this.images_results_counter=0,this.news_results_counter=0,this.text_results_counter=0,this.videos_results_counter=0,this.sub_scroll_chunk=50,this.sub_scroll_down_chunk_delay=25,this.sub_scroll_down_delay=500,this.sub_scroll_waiting_for_more=100,this.consent_checks=5,this.step="",this.step_attempts=5}start(){this.debug&&console.log("Bot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1)}))}async navigate(){console.log("navigate",location.href),this.is_text_result_page()?(console.log("this.is_text_result_page()"),this.step="text_animation",this.text_animation()):this.is_news_result_page()?(console.log("this.is_news_result_page()"),this.step="news_animation",this.news_animation()):this.is_images_result_page()?(console.log("this.is_images_result_page()"),this.step="images_animation",this.images_animation()):this.is_videos_result_page()?(console.log("this.is_videos_result_page()"),this.step="videos_animation",this.videos_animation()):(console.log("this.constant_consent_check()"),this.constant_consent_check(),console.log("this.start_navigation()"),this.step="start_navigation",this.start_navigation()),this.extension.set_iter_step(this.step)}set_navigate_timeout(t=null){null==t&&(t=this.navigate_delay),console.log("set_navigate_timeout"),setTimeout(function(){this.navigate()}.bind(this),t)}text_animation(){this.is_text_result_pages_end()?this.set_text_results_animation(this.set_get_news_tab_timeout):this.set_text_results_animation(this.set_get_next_button_text_result_timeout)}news_animation(){this.is_news_result_pages_end()?this.set_news_results_animation(this.set_get_images_tab_timeout):(console.log("continue news animation"),this.set_news_results_animation(this.set_get_next_button_news_result_timeout))}images_animation(t=null){null==t&&(t=this.initial_scroll_delay),this.is_images_result_scrolls_end()?(this.images_results_counter=0,this.scroll_down().then((t=>this.set_get_videos_tab_timeout()))):setTimeout(function(){this.scroll_down().then((t=>this.images_animation(0)))}.bind(this),t)}videos_animation(){this.is_videos_result_pages_end()?this.set_videos_results_animation(this.go_to_base_page):this.set_videos_results_animation(this.set_get_next_button_videos_timeout)}more_text_animation(){this.set_click_more_text_timeout().then((t=>this.text_animation(500)))}set_click_more_text_timeout(){return new Promise(((t,e)=>{setTimeout(function(){this.click_more_text(),t(!0)}.bind(this),250)}))}click_more_text(){this.click_or_reload(this.get_more_text_button())}more_news_animation(){this.set_click_more_news_timeout().then((t=>this.news_animation(500)))}set_click_more_news_timeout(){return new Promise(((t,e)=>{setTimeout(function(){this.click_more_news(),t(!0)}.bind(this),250)}))}click_more_news(){this.click_or_reload(this.get_more_news_button())}more_images_animation(){this.set_click_more_images_timeout().then((t=>this.images_animation(500)))}set_click_more_images_timeout(){return new Promise(((t,e)=>{setTimeout(function(){this.click_more_images(),t(!0)}.bind(this),150)}))}click_more_images(){this.click_or_reload(this.get_more_images_button())}more_videos_animation(){this.set_click_more_videos_timeout().then((t=>this.videos_animation(500)))}set_click_more_videos_timeout(){return new Promise(((t,e)=>{setTimeout(function(){this.click_more_videos(),t(!0)}.bind(this),150)}))}click_more_videos(){this.click_or_reload(this.get_more_videos_button())}start_navigation(){this.extension.steady()}search(t,e){setTimeout(function(){this.set_mainpage_animation(t)}.bind(this),this.next_delay)}go_to_base_page(){console.log("Go to base page"),setTimeout(function(){this.extension.go_to_base_page()}.bind(this),this.next_delay)}constant_consent_check(){return console.log("constant_consent_check"),new Promise((async(t,e)=>{let s=1;var n=setInterval(function(){console.log("checking for consent",s),this.is_collect_consent_page()?(this.consent_animation(),clearInterval(n)):(s>=this.consent_checks&&(console.log("bye intervals",s),clearInterval(n)),s+=1)}.bind(this),3e3)}))}consent_animation(){}is_collect_consent_page(){return!1}is_text_result_pages_end(){console.log("is_text_result_pages_end()");let t=this.get_text_result_page();return console.log("\n\nPage Count: "+t+"\n\n"),this.result_text_pages<=t}is_news_result_pages_end(){console.log("is_news_result_pages_end()");let t=this.get_news_result_page();return console.log("\n\nPage Count: "+t+"\n\n"),this.result_news_pages<=t}is_videos_result_pages_end(){console.log("is_videos_result_pages_end()");let t=this.get_videos_result_page();return console.log("\n\nPage Count: "+t+"\n\n"),this.result_videos_pages<=t}is_images_result_pages_end(){console.log("is_images_result_pages_end()");let t=this.get_images_result_page();return console.log("\n\nPage Count: "+t+"\n\n"),this.result_images_pages<=t}is_text_result_scrolls_end(){console.log("is_text_result_scrolls_end()");let t=this.get_text_result_page();return console.log("\n\nScroll Count: "+t+"\n\n"),this.scroll_text_reloads<=t}is_news_result_scrolls_end(){console.log("is_news_result_scrolls_end()");let t=this.get_news_result_page();return console.log("\n\nScroll Count: "+t+"\n\n"),this.scroll_news_reloads<=t}is_videos_result_scrolls_end(){console.log("is_videos_result_scrolls_end()");let t=this.get_videos_result_page();return console.log("\n\nScroll Count: "+t+"\n\n"),this.scroll_videos_reloads<=t}is_images_result_scrolls_end(){console.log("is_images_result_scrolls_end()");let t=this.get_images_result_page();return console.log("\n\nScroll Count: "+t+"\n\n"),this.scroll_images_reloads<=t}set_mainpage_animation(t,e=500){setTimeout(function(){this.type_search(t)}.bind(this),e)}set_get_search_button_timeout(t=1e3){setTimeout(function(){this.click_or_reload(this.get_search_button())}.bind(this),t)}set_videos_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>t.bind(this)()))}.bind(this),this.initial_scroll_delay)}set_text_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>t.bind(this)()))}.bind(this),this.initial_scroll_delay)}set_news_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>t.bind(this)()))}.bind(this),this.initial_scroll_delay)}set_get_next_button_text_result_timeout(){return new Promise((async(t,e)=>{setTimeout(function(){this.click_or_reload(this.get_next_button()),t(!0)}.bind(this),this.next_delay)}))}set_get_next_button_news_result_timeout(){return new Promise((async(t,e)=>{setTimeout(function(){console.log("this.click_or_move_to_images(this.get_next_button_news());"),this.click_or_move_to_images(this.get_next_button_news()),t(!0)}.bind(this),this.next_delay)}))}set_get_next_button_videos_timeout(){return new Promise((async(t,e)=>{setTimeout(function(){this.click_or_reload(this.get_next_button_videos()),t(!0)}.bind(this),this.next_delay)}))}set_get_news_tab_timeout(){return new Promise((async(t,e)=>{setTimeout(function(){this.click_or_reload(this.get_news_tab()),t(!0)}.bind(this),this.next_delay)}))}set_get_images_tab_timeout(){return new Promise((async(t,e)=>{setTimeout(function(){this.click_or_reload(this.get_images_tab()),t(!0)}.bind(this),this.next_delay)}))}set_get_videos_tab_timeout(){return new Promise((async(t,e)=>{setTimeout(function(){this.click_or_reload(this.get_videos_tab()),t(!0)}.bind(this),this.next_delay)}))}is_news_loaded(){return!0}click_or_move_to_images(t){console.log(t),t?t.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})):(console.log("Moving to images (Promise)..."),setTimeout(function(){console.log("is_it_loaded",this.is_news_loaded()),this.is_news_loaded()?(console.log("is_news_loaded"),this.set_news_results_animation(this.set_get_images_tab_timeout)):location.reload()}.bind(this),500))}click_or_reload(t){if(console.log(t),t)t.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}));else{this.extension.get_iter_step(this.step)<this.step_attempts&&(console.log("Reloading..."),location.reload())}}click_or_reload_promise(t){return new Promise((async(e,s)=>{if(console.log(t),t)t.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),e(!0);else{console.log("Reloading (Promise)..."),this.extension.get_iter_step(this.step)<this.step_attempts&&(console.log("Reloading..."),location.reload())}}))}type_search(t){var e=this.get_search_input();e.focus();var s=0,n=this,o=0;!function i(){if(s<t.length){let r=t.charAt(s);e.value+=r,e.dispatchEvent(new KeyboardEvent("keypress",{key:r})),e.dispatchEvent(new KeyboardEvent("keydown",{key:r})),e.dispatchEvent(new KeyboardEvent("keyup",{key:r})),s++,setTimeout(i,100)}else{function _(){console.log("now input.value is: ",e.value),e.value==t?(console.log("value is correct"),n.set_get_search_button_timeout()):o<1?(console.log("try again typing: "+t),e.value="",s=0,o+=1,setTimeout(i,100)):(console.log("give up, just paste the keyword: "+t),e.value=t,n.set_get_search_button_timeout())}console.log("input.value is: ",e.value),n.clear_autosuggestion_box(),setTimeout(_,1e3)}}()}clear_autosuggestion_box(){}clear_browser(){return new Promise((async(t,e)=>{this.extension.settings.clear_browser_flag?(localStorage.clear(),sessionStorage.clear(),this.deleteAllCookies(),this.clear_cookies()):console.log("NOT DELETING BROWSING DATA! Check settings.clear_browser"),this.extension.clear_browser(),t(!0)}))}clear_cookies(){for(var t=document.cookie.split("; "),e=0;e<t.length;e++)for(var s=window.location.hostname.split(".");s.length>0;){var n=encodeURIComponent(t[e].split(";")[0].split("=")[0])+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain="+s.join(".")+" ;path=",o=location.pathname.split("/");for(document.cookie=n+"/";o.length>0;)document.cookie=n+o.join("/"),o.pop();s.shift()}}deleteAllCookies(){for(var t=document.cookie.split(";"),e=0;e<t.length;e++){var s=t[e],n=s.indexOf("="),o=n>-1?s.substr(0,n):s;document.cookie=o+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}find_get_parameter(t){var e=null,s=[];return location.search.substr(1).split("&").forEach((function(n){(s=n.split("="))[0]===t&&(e=decodeURIComponent(s[1]))})),e}timed_scroll_down(t){return new Promise((async(e,s)=>{setTimeout(async function(){this.scroll_down().then(e(!0))}.bind(this),t)}))}scroll_down(){return new Promise((async(t,e)=>{let s=document.documentElement.scrollHeight-document.documentElement.clientHeight,n=document.documentElement.scrollTop;for(s=Math.min(s,n+7500),console.log("_scroll (current):",n),console.log("bottom (target):",s);n<s;)await this.sub_scroll_down(n,n+document.documentElement.clientHeight),n+=document.documentElement.clientHeight,window.scrollTo(0,n);t(!0)}))}sub_scroll_down(t,e){return new Promise(((s,n)=>{setTimeout(async function(){let n=setInterval(function(){if(t<e)t+=this.sub_scroll_chunk,window.scrollTo(0,t);else{clearInterval(n);let t=document.documentElement.scrollHeight-document.documentElement.clientHeight;document.documentElement.scrollTop>=t?setTimeout((function(){s(!0)}),this.sub_scroll_waiting_for_more):s(!0)}}.bind(this),this.sub_scroll_down_chunk_delay)}.bind(this),this.sub_scroll_down_delay)}))}onStart(t){this.debug&&console.log("Bot -> onStart()"),t(1e3)}}class n extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this),this.debug}start(){this.debug&&console.log("GoogleBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}consent_animation(){setTimeout(function(){let t=this.get_consent_button();t&&t.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}.bind(this),100)}get_search_input(){return document.querySelector("input[name=q]")}get_consent_button(){return document.querySelector("#L2AGLb")}is_collect_consent_page(){let t=this.get_consent_button();return console.log("Consent page detected: ",null!=t),null!=t}is_text_result_page(){return"/search"==window.location.pathname&&null==this.find_get_parameter("tbm")}is_news_result_page(){return"nws"==this.find_get_parameter("tbm")}is_images_result_page(){return"isch"==this.find_get_parameter("tbm")}is_videos_result_page(){return"vid"==this.find_get_parameter("tbm")}get_search_button(){return document.querySelector("input[name=btnK]")}get_news_tab(){return document.querySelector("a[href*='tbm=nws']")}get_images_tab(){return document.querySelector("a[href*='tbm=isch']")}get_videos_tab(){return document.querySelector("a[href*='tbm=vid']")}get_next_button(){return document.querySelector("a#pnnext")}get_next_button_news(){return document.querySelector("a#pnnext")}get_next_button_videos(){return document.querySelector("a#pnnext")}get_text_result_page(){let t=this.find_get_parameter("start");return t?parseInt(t)/10+1:1}get_news_result_page(){let t=this.find_get_parameter("start");return t?parseInt(t)/10+1:1}get_images_result_page(){return this.images_results_counter+=1,this.images_results_counter}get_videos_result_page(){let t=this.find_get_parameter("start");return t?parseInt(t)/10+1:1}onStart(t){this.debug&&console.log("GoogleBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Google START!!!!"),t(1e3)}),500)}}class o extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this)}start(){this.debug&&console.log("GoogleBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}async navigate(){console.log("navigate",location.href),this.is_collect_consent_page()?(console.log("this.is_collect_consent_page()"),this.consent_animation()):(console.log("Consented"),window.location="https://www.google.com")}consent_animation(){setTimeout(function(){let t=document.querySelector("#introAgreeButton");this.click_or_reload(t)}.bind(this),200)}is_collect_consent_page(){return console.log("Consent page detected: ",null!=document.querySelector("#introAgreeButton")),null!=document.querySelector("#introAgreeButton")}onStart(t){this.debug&&console.log("GoogleBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Google START!!!!"),t(1e3)}),500)}}class i extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this)}start(){this.debug&&console.log("YahooBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}async navigate(){console.log("navigate",location.href),this.is_collect_consent_page()&&(console.log("this.is_collect_consent_page()"),this.consent_animation())}consent_animation(){setTimeout(function(){document.querySelector("form.consent-form")&&document.querySelector("form.consent-form button[name=agree]").dispatchEvent(new MouseEvent("click"))}.bind(this),100)}is_collect_consent_page(){return location.pathname.includes("/collectConsent")}onStart(t){this.debug&&console.log("YahooBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Yahoo START!!!!"),t(1e3)}),500)}}class r extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this),this.debug||(this.scroll_images_reloads=4),this.initial_scroll_delay=1e3}start(){this.debug&&console.log("DuckDuckGoBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}text_animation(t=0){this.is_text_result_scrolls_end()?(this.text_results_counter=0,setTimeout(function(){this.scroll_down().then((t=>this.set_get_news_tab_timeout().then((t=>this.set_navigate_timeout()))))}.bind(this),this.initial_scroll_delay+t)):setTimeout(function(){this.scroll_down().then((t=>this.more_text_animation()))}.bind(this),this.initial_scroll_delay+t)}get_more_text_button(){return document.querySelector("a.result--more__btn")}news_animation(t=0){this.is_news_result_scrolls_end()?(console.log("End of news"),this.news_results_counter=0,setTimeout(function(){this.scroll_down().then((t=>this.set_get_images_tab_timeout().then((t=>this.set_navigate_timeout()))))}.bind(this),this.initial_scroll_delay+t)):(console.log("Continue news"),setTimeout(function(){this.scroll_down().then((t=>this.more_news_animation()))}.bind(this),this.initial_scroll_delay+t))}get_more_news_button(){return document.querySelector("a.result--more__btn")}images_animation(t=null){null==t&&(t=this.initial_scroll_delay),this.is_images_result_scrolls_end()?(this.images_results_counter=0,this.scroll_down().then((t=>this.set_get_videos_tab_timeout().then((t=>this.set_navigate_timeout()))))):setTimeout(function(){this.scroll_down().then((t=>this.images_animation(0)))}.bind(this),t)}videos_animation(t=null){null==t&&(t=this.initial_scroll_delay),this.is_videos_result_scrolls_end()?(this.videos_results_counter=0,this.scroll_down().then((t=>this.go_to_base_page()))):setTimeout(function(){this.scroll_down().then((t=>this.videos_animation(0)))}.bind(this),t)}get_search_input(){return document.querySelector("#search_form_input_homepage")}is_text_result_page(){return null!=this.find_get_parameter("q")&&!this.is_images_result_page()&&!this.is_videos_result_page()&&!this.is_news_result_page()}is_news_result_page(){return"news"==this.find_get_parameter("ia")}is_images_result_page(){return"images"==this.find_get_parameter("ia")}is_videos_result_page(){return"videos"==this.find_get_parameter("ia")}get_search_button(){return document.querySelector("#search_button_homepage")}get_news_tab(){return document.querySelector("#duckbar a.js-zci-link--news")}get_images_tab(){return document.querySelector("#duckbar a.js-zci-link--images")}get_videos_tab(){return document.querySelector("#duckbar a.js-zci-link--videos")}get_text_result_page(){return this.text_results_counter+=1,this.text_results_counter}get_news_result_page(){return this.news_results_counter+=1,this.news_results_counter}get_images_result_page(){return this.images_results_counter+=1,this.images_results_counter}get_videos_result_page(){return this.videos_results_counter+=1,this.videos_results_counter}scroll_down(){return new Promise((async(t,e)=>{let s=document.documentElement.scrollHeight-document.documentElement.clientHeight,n=document.documentElement.scrollTop;for(s=Math.min(s,n+7500),console.log("_scroll (current):",n),console.log("bottom (target):",s);n<s;)await this.sub_scroll_down(n,n+document.documentElement.clientHeight),n+=document.documentElement.clientHeight,window.scrollTo(0,n);t(!0)}))}onStart(t){this.debug&&console.log("DuckDuckGoBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("DuckDuckGo START!!!!"),t(1e3)}),500)}}class _ extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this),this.debug,this.result_text_pages=1,this.result_news_pages=1,this.scroll_text_reloads=1,this.scroll_news_reloads=1,this.initial_scroll_delay=3e3}start(){this.debug&&console.log("YandexBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}videos_animation(t=0){this.is_videos_result_scrolls_end()?(this.videos_results_counter=0,setTimeout(function(){this.scroll_down().then((t=>this.go_to_base_page()))}.bind(this),this.initial_scroll_delay+t)):setTimeout(function(){this.scroll_down().then((t=>this.more_videos_animation()))}.bind(this),this.initial_scroll_delay+t)}set_videos_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>this.timed_scroll_down(1e3).then((e=>t.bind(this)()))))}.bind(this),this.initial_scroll_delay)}get_more_videos_button(){return document.querySelector("div.more_last_yes button")}get_search_input(){return document.querySelector("input#text")}consent_animation(){setTimeout(function(){let t=document.querySelector("table button[data-id=button-all]");t&&t.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}.bind(this),100)}is_collect_consent_page(){return console.log("Consent page detected: ",null!=document.querySelector("table button[data-id=button-all]")),null!=document.querySelector("table button[data-id=button-all]")}is_text_result_page(){return console.log("is_text_result_page"),location.pathname.includes("/search/")}is_news_result_page(){return console.log("is_news_result_page"),location.hostname.includes("newssearch")}is_images_result_page(){return console.log("is_images_result_page"),location.pathname.includes("/images/")}is_videos_result_page(){return console.log("is_videos_result_page"),!!location.pathname.includes("/video/")&&(this.sub_scroll_waiting_for_more=3e3,this.sub_scroll_down_delay=1e3,!0)}get_news_tab(){let t=document.querySelector("a[href*='newssearch.']");return t.removeAttribute("target"),t}get_images_tab(){let t=document.querySelector("a[href*='/images/']");return t.removeAttribute("target"),t}get_videos_tab(){let t=document.querySelector("a[href*='/video/']");return t.removeAttribute("target"),t}get_search_button(){return document.querySelector("div.search2__button button")}get_next_button(){return document.querySelector("a.pager__item_kind_next")}get_next_button_news(){let t=document.querySelectorAll("span.pager__group a.button");return t[t.length-1]}get_text_result_page(){let t=this.find_get_parameter("p");return t?parseInt(t)+1:1}get_news_result_page(){let t=this.find_get_parameter("p");return t?parseInt(t)+1:1}get_images_result_page(){return this.images_results_counter+=1,this.images_results_counter}get_videos_result_page(){return this.videos_results_counter+=1,this.videos_results_counter}onStart(t){this.debug&&console.log("YandexBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Yandex START!!!!"),t(1e3)}),500)}}class l extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this),this.debug||(this.result_text_pages=50,this.scroll_news_reloads=10,this.scroll_images_reloads=10,this.scroll_videos_reloads=14)}start(){this.debug&&console.log("BingBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}news_animation(t=null){console.log("news_animation"),null==t&&(t=this.initial_scroll_delay),this.is_news_result_scrolls_end()?(this.news_results_counter=0,this.scroll_down().then((t=>this.set_get_images_tab_timeout()))):setTimeout(function(){this.scroll_down().then((t=>this.news_animation(0)))}.bind(this),t)}images_animation(t=null){console.log("images_animation"),null==t&&(t=this.initial_scroll_delay),this.is_images_result_scrolls_end()?(this.images_results_counter=0,this.scroll_down().then((t=>this.set_get_videos_tab_timeout()))):setTimeout(function(){this.scroll_down().then((t=>this.images_animation(0)))}.bind(this),t)}videos_animation(t=null){console.log("videos_animation"),null==t&&(t=this.initial_scroll_delay),this.is_videos_result_scrolls_end()?(this.videos_results_counter=0,this.scroll_down().then((t=>this.go_to_base_page()))):setTimeout(function(){this.scroll_down().then((t=>this.videos_animation(0)))}.bind(this),t)}consent_animation(){setTimeout(function(){console.log("CLICKING!!!!");let t=document.querySelector("#bnp_btn_accept");t&&t.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}.bind(this),100)}is_collect_consent_page(){return console.log("Consent page detected: ",null!=document.querySelector("#bnp_btn_accept")),null!=document.querySelector("#bnp_btn_accept")}set_get_next_button_text_result_timeout(){return new Promise((async(t,e)=>{setTimeout(function(){console.log("click_or_reload_promise");this.get_search_button();let e=window.location.protocol+"//"+window.location.hostname+document.querySelector("a.sb_pagN").getAttribute("href");this.force_location(e),t(!0)}.bind(this),this.next_delay)}))}force_location(t){console.log("force location",t),setTimeout(function(){window.location=t}.bind(this),1500)}set_get_search_button_timeout(t=0){this.click_or_reload(this.get_search_button())}get_search_input(){return document.querySelector("input#sb_form_q")}clear_autosuggestion_box(){let t=document.querySelector("div#sw_as");t&&t.remove()}is_text_result_page(){return location.pathname.includes("/search")&&!this.is_images_result_page()&&!this.is_videos_result_page()&&!this.is_news_result_page()}is_news_result_page(){return location.pathname.includes("/news/")}is_images_result_page(){return location.pathname.includes("/images/")}is_videos_result_page(){return!!location.pathname.includes("/videos/")&&(this.sub_scroll_waiting_for_more=1500,!0)}get_search_button(){return document.querySelector("input#sb_form_go")}get_news_tab(){return document.querySelector("a[href*='/news/']")}get_images_tab(){return document.querySelector("a[href*='/images/']")}get_videos_tab(){return document.querySelector("a[href*='/videos/']")}get_next_button(){return console.log("Next Button",document.querySelector("a.sb_pagN")),document.querySelector("a.sb_pagN")}get_text_result_page(){let t=this.find_get_parameter("first");return t?parseInt(t):1}get_news_result_page(){return this.news_results_counter+=1,this.news_results_counter}get_images_result_page(){return this.images_results_counter+=1,this.images_results_counter}get_videos_result_page(){return this.videos_results_counter+=1,this.videos_results_counter}onStart(t){this.debug&&console.log("BingBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Bing START!!!!"),t(1e3)}),500)}}class a extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this),this.debug||(this.scroll_images_reloads=5),this.sub_scroll_waiting_for_more=500}start(){this.debug&&console.log("YahooBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}consent_animation(){setTimeout(function(){document.querySelector("form.consent-form")&&document.querySelector("form.consent-form button[name=agree]").dispatchEvent(new MouseEvent("click"))}.bind(this),100)}images_animation(t=0){this.is_images_result_scrolls_end()?(this.images_results_counter=0,setTimeout(function(){this.scroll_down().then((t=>this.set_get_videos_tab_timeout()))}.bind(this),this.initial_scroll_delay+t)):setTimeout(function(){this.scroll_down().then((t=>this.more_images_animation()))}.bind(this),this.initial_scroll_delay+t)}videos_animation(t=0){this.is_videos_result_scrolls_end()?(this.videos_results_counter=0,setTimeout(function(){this.scroll_down().then((t=>this.go_to_base_page()))}.bind(this),this.initial_scroll_delay+t)):setTimeout(function(){this.scroll_down().then((t=>this.more_videos_animation()))}.bind(this),this.initial_scroll_delay+t)}get_more_videos_button(){return document.querySelector("section#search button.more")}get_more_images_button(){return document.querySelector("section#results button.more-res")}get_search_input(){return document.querySelector("form[role=search] input")}is_collect_consent_page(){return location.pathname.includes("/collectConsent")}is_text_result_page(){return location.pathname.includes("/search")&&!this.is_images_result_page()&&!this.is_videos_result_page()&&!this.is_news_result_page()}is_news_result_page(){return location.hostname.includes("news.search")}is_images_result_page(){return location.pathname.includes("/search/images")}is_videos_result_page(){return location.pathname.includes("/search/video")}get_search_button(){return document.querySelector("form[role=search] span[role=button]")}get_images_tab(){return document.querySelector("a[href*='/search/images']")}get_news_tab(){return document.querySelector("a[href*='news.search']")}get_videos_tab(){return document.querySelector("a[href*='/search/video']")}get_next_button(){return document.querySelector("a.next")}get_next_button_news(){return document.querySelector("a.next")}get_text_result_page(){let t=this.find_get_parameter("b");return t?Math.floor(parseInt(t)/10)+1:1}get_news_result_page(){let t=this.find_get_parameter("b");return t?Math.floor(parseInt(t)/10)+1:1}get_images_result_page(){return this.images_results_counter+=1,this.images_results_counter}get_videos_result_page(){return this.videos_results_counter+=1,this.videos_results_counter}onStart(t){this.debug&&console.log("YahooBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Yahoo START!!!!"),t(1e3)}),500)}}class u extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this),this.initial_scroll_delay=3e3,this.debug||(this.result_text_pages=5,this.scroll_videos_reloads=7,this.scroll_images_reloads=7),this.sub_scroll_down_delay=1e3}start(){this.debug&&console.log("BaiduBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}images_animation(t=null){console.log("images_animation"),null==t&&(t=this.initial_scroll_delay),this.is_images_result_scrolls_end()?(this.images_results_counter=0,this.scroll_down().then((t=>this.set_get_videos_tab_timeout().then((t=>this.set_navigate_timeout()))))):setTimeout(function(){this.scroll_down().then((t=>this.images_animation(500)))}.bind(this),t)}videos_animation(t=null){console.log("videos_animation"),null==t&&(t=this.initial_scroll_delay),this.is_videos_result_scrolls_end()?(this.videos_results_counter=0,this.scroll_down().then((t=>this.go_to_base_page()))):setTimeout(function(){this.scroll_down().then((t=>this.videos_animation(0)))}.bind(this),t)}set_get_search_button_timeout(t=1e3){setTimeout(function(){this.click_or_reload_promise(this.get_search_button()).then((t=>this.set_navigate_timeout()))}.bind(this),t)}set_text_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>t.bind(this)().then((t=>this.set_navigate_timeout()))))}.bind(this),this.initial_scroll_delay)}get_search_input(){return document.querySelector("input#kw")}is_text_result_page(){return location.pathname.includes("/s")&&!this.is_images_result_page()&&!this.is_videos_result_page()&&!this.is_news_result_page()}is_news_result_page(){return!!location.href.includes("tn=news")}is_images_result_page(){return!!location.hostname.includes("image.")&&(this.sub_scroll_waiting_for_more=3e3,!0)}is_videos_result_page(){return!!location.pathname.includes("/vsearch")&&(this.sub_scroll_waiting_for_more=3e3,!0)}get_search_button(){return document.querySelector("form input#su")}get_news_tab(){return document.querySelector("div.s_tab_inner a[href*='tn=news']")}get_images_tab(){return document.querySelector("div.s_tab_inner a[href*='tn=baiduimage']")}get_videos_tab(){let t=document.querySelector("a[name='i_video']");return t.dispatchEvent(new MouseEvent("mousedown")),t}get_next_button(){let t=document.querySelectorAll("div#page a.n");return t?t[t.length-1]:null}is_news_loaded(){return!0}get_next_button_news(){let t=document.querySelectorAll("div#page a.n");return this.find_get_parameter("pn")?2==t.length?t[1]:null:t?t[t.length-1]:null}get_text_result_page(){let t=this.find_get_parameter("pn");return t?Math.floor(parseInt(t)/10)+1:1}get_news_result_page(){let t=this.find_get_parameter("pn");return t?Math.floor(parseInt(t)/10)+1:1}get_images_result_page(){return console.log("\n\n"),console.log(this.images_results_counter),console.log("\n\n"),this.images_results_counter+=1,this.images_results_counter}get_videos_result_page(){return console.log("\n\n"),console.log(this.videos_results_counter),console.log("\n\n"),this.videos_results_counter+=1,this.videos_results_counter}onStart(t){this.debug&&console.log("BaiduBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Baidu START!!!!"),t(1500)}),1e3)}}class c extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this),this.debug||(this.result_text_pages=5,this.result_videos_pages=5,this.scroll_images_reloads=10),this.initial_scroll_delay=2e3,this.sub_scroll_down_delay=1e3}start(){this.debug&&console.log("SoBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}set_videos_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>this.timed_scroll_down(500).then((e=>t.bind(this)()))))}.bind(this),this.initial_scroll_delay)}set_text_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>t.bind(this)().then((t=>this.set_navigate_timeout()))))}.bind(this),this.initial_scroll_delay)}get_search_input(){return document.querySelector("input#input")}is_text_result_page(){return"/s"==window.location.pathname}is_images_result_page(){return"/i"==window.location.pathname&&(this.sub_scroll_waiting_for_more=3e3,!0)}is_videos_result_page(){return"/v"==window.location.pathname}get_search_button(){return document.querySelector("input#search-button")}get_images_tab(){return document.querySelector("div#tabs-wrap a[href*='/i']")}get_videos_tab(){return document.querySelector("div.sitenav a[href*='/v']")}get_next_button(){return document.querySelector("a#snext")}get_next_button_videos(){return document.querySelector("a.js-next")}get_text_result_page(){let t=this.find_get_parameter("pn");return t?parseInt(t):1}get_images_result_page(){return this.images_results_counter+=1,console.log("\n\n",this.images_results_counter,"\n\n"),this.images_results_counter}get_videos_result_page(){let t=this.find_get_parameter("pageno");return t?parseInt(t):1}onStart(t){this.debug&&console.log("SoBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("So START!!!!"),t(1e3)}),500)}}class h extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this),this.debug||(this.result_text_pages=5,this.result_videos_pages=5,this.scroll_images_reloads=6)}start(){this.debug&&console.log("SogouBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}set_text_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>this.timed_scroll_down(2e3).then((e=>t.bind(this)().then((t=>this.set_navigate_timeout()))))))}.bind(this),this.initial_scroll_delay)}set_videos_results_animation(t){setTimeout(function(){this.scroll_down().then((e=>t.bind(this)().then((t=>this.set_navigate_timeout()))))}.bind(this),this.initial_scroll_delay)}get_search_input(){return document.querySelector("input#query")}is_text_result_page(){return"/web"==window.location.pathname}is_images_result_page(){return"/pics"==window.location.pathname}is_videos_result_page(){return"/v"==window.location.pathname}get_search_button(){return document.querySelector("input#stb")}get_images_tab(){return document.querySelector("a[href*='/pics']")}get_videos_tab(){return document.querySelector("a[href*='/v']")}get_next_button(){return document.querySelector("a#sogou_next")}get_next_button_videos(){let t=new URL(location.href);return t.searchParams.set("vpage",this.get_videos_result_page()+1),history.pushState("","",t.search),document.querySelector("a.btn_pg.btn_nxt")}get_text_result_page(){let t=this.find_get_parameter("page");return t?parseInt(t):1}get_images_result_page(){return this.images_results_counter+=1,this.images_results_counter}get_videos_result_page(){let t=document.querySelector("a.btn_pg.btn_pg_num.on");if(t){let e=t.getAttribute("data-num");if(e)return parseInt(e)}return console.warn("data-num not found"),1}onStart(t){this.debug&&console.log("SogouBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Sogou START!!!!"),t(1e3)}),500)}}class g extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this)}start(){this.debug&&console.log("BasePageBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}async navigate(){console.log("navigate",location.href),this.set_go_to_next_engine()}set_go_to_next_engine(){this.clear_browser().then((t=>this.go_to_next_engine()))}go_to_next_engine(){console.log("Go to next engine"),setTimeout(function(){this.extension.go_to_next_engine()}.bind(this),5e3)}onStart(t){this.debug&&console.log("BasePageBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("BasePage START!!!!"),t(1e3)}),500)}}class d extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this)}start(){this.debug&&console.log("CaptchaBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}async navigate(){console.log("navigate",location.href),console.log("Go to base page:",new Date),setTimeout(function(){this.extension.go_to_base_page()}.bind(this),6e4)}onStart(t){this.debug&&console.log("CaptchaBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("Captcha START!!!!"),t(1e3)}),500)}}class m extends e{constructor(t,e){super(t,e),this.onStart=this.onStart.bind(this)}start(){this.debug&&console.log("YandexCaptchaBot -> start()"),this.onStart((t=>{this.eventEmitter.emit(this.EVENT_NAMES.start,t,!1),this.navigate()}))}async navigate(){console.log("navigate",location.href),console.log("Go to Yandex Base page:",new Date),await this.extension.set_iter_step("yandex_captcha"),setTimeout(async function(){await this.extension.get_iter_step("yandex_captcha")<this.step_attempts?this.extension.resume_search_from("/images/search?text="):this.extension.go_to_base_page()}.bind(this),6e4)}onStart(t){this.debug&&console.log("YandexCaptchaBot -> onStart()"),setTimeout((()=>{this.debug&&console.log("YandexCaptcha START!!!!"),t(1e3)}),500)}}let b=new class{constructor(){this.isListeningToBackend=!1,this.browser=window.hasOwnProperty("chrome")?chrome:browser,this.debug=!1,this.onBackendMessage=this.onBackendMessage.bind(this),this.settings={}}_getBot(){console.log(this.settings);let t=window.location.hostname.split("."),e=window.location.toString();if(t.length>1){let s=t[t.length-2];if(e.includes("captcha"))return"yandex"==s?(this.debug&&console.log("YandexCaptchaBot"),m):d;if("google"==s){if(console.log("google"),t.length>2){if(s=t[t.length-3],"consent"==s)return this.debug&&console.log("GoogleConsentBot"),o;if("scholar"==s)return null}return this.debug&&console.log("GoogleBot"),n}if("duckduckgo"==s)return this.debug&&console.log("DuckDuckGoBot"),r;if("yandex"==s)return this.debug&&console.log("YandexBot"),_;if("bing"==s)return this.debug&&console.log("BingBot"),l;if("yahoo"==s)return t.length>2&&(s=t[t.length-3],"consent"==s)?(this.debug&&console.log("YahooConsentBot"),i):(this.debug&&console.log("YahooBot"),a);if("baidu"==s)return this.debug&&console.log("BaiduBot"),u;if("so"==s||"360kan"==s)return this.debug&&console.log("SoBot"),c;if("sogou"==s)return this.debug&&console.log("SogouBot"),h}return window.location.hostname==this.browser.i18n.getMessage("@@extension_id")?(this.debug&&console.log("BasePageBot"),g):(this.debug&&console.log("Bot"),null)}_getParam(){return new Promise(((t,e)=>{this.debug&&console.log('sendMessage("on_start")'),this.browser.runtime.sendMessage("on_start",(e=>{this.browser.runtime.lastError,this.settings=e,t(e)}))}))}get_engine_url(){return location.protocol+"//"+location.hostname}steady(){return new Promise(((t,e)=>{this.debug&&console.log('sendMessage("steady")'),console.log(this.get_engine_url()),this.browser.runtime.sendMessage({steady:!0,engine:this.get_engine_url()},(e=>{this.browser.runtime.lastError,t(e)}))}))}clear_browser(){return new Promise(((t,e)=>{this.debug&&console.log('sendMessage("clear_browser")'),this.browser.runtime.sendMessage({clear_browser:!0},(e=>{this.browser.runtime.lastError,t(e)}))}))}set_iter_step(t){return new Promise(((e,s)=>{this.debug&&console.log('sendMessage("set_iter_step")'),this.browser.runtime.sendMessage({set_iter_step:!0,step:t},(t=>{this.browser.runtime.lastError,e(t.iterator)}))}))}get_iter_step(t){return new Promise(((e,s)=>{this.debug&&console.log('sendMessage("get_iter_step")'),this.browser.runtime.sendMessage({get_iter_step:!0,step:t},(t=>{this.browser.runtime.lastError,e(t.iterator)}))}))}go_to_base_page(){return new Promise(((t,e)=>{this.debug&&console.log('sendMessage("go_to_base_page")'),this.browser.runtime.sendMessage({go_to_base_page:!0},(e=>{this.browser.runtime.lastError,t(e)}))}))}resume_search_from(t){return new Promise(((e,s)=>{this.debug&&console.log('sendMessage("get_current_search")'),this.browser.runtime.sendMessage({get_current_search:!0},(s=>{this.browser.runtime.lastError,window.location.replace(s.current_engine+t+s.current_keyword),e(s)}))}))}go_to_next_engine(){return new Promise(((t,e)=>{this.debug&&console.log('sendMessage("get_next_engine")'),this.browser.runtime.sendMessage({get_next_engine:!0},(e=>{this.browser.runtime.lastError,window.location.replace(e.next_engine),t(e)}))}))}_clean_www(t){return t.startsWith("www.")?t.substr(4):t}onBackendMessage(t,e,s){if(this.debug&&console.log(t),"init"==t.action)this.debug&&console.log("onBackendMessage: init"),null==this.bot&&this.init(),s(!0);else if("search"==t.action){this.debug&&console.log("onBackendMessage: search");let e=new URL(t.engine).hostname;this._clean_www(location.hostname)==this._clean_www(e)&&"/"==location.pathname?(this.bot.search(t.keyword,t.engine),s(!0)):(console.log("not main page",this._clean_www(location.hostname),this._clean_www(e)),window.location.replace(t.engine),s(!1))}}createBot(){this.debug&&console.log("-> createBot()");const t=this._getBot();null!=t&&(this.bot=new t(this),this.bot.eventEmitter.on("onNewURL",(()=>{this.init()})),this.bot.eventEmitter.on("onStart",(async t=>{this.debug&&console.log("onStart this.sendMessage")})),this.browser.runtime.connect({name:"content_handler_connection"}).onDisconnect.addListener(function(t){this.debug&&console.log(t),this.init_timer&&clearTimeout(this.init_timer)}.bind(this)),this.bot.start())}async init(){this.isListeningToBackend||(this.browser.runtime.onMessage.addListener(this.onBackendMessage),this.isListeningToBackend=!0);try{"object"==typeof await this._getParam()&&this.createBot()}catch(t){this.init_timer=setTimeout((()=>this.init()),2e3),console.log(t)}}};b.init()})()})();